<!-- customer-detail.html -->
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
  </head>
  <body>
    <div class="container mt-5">
      <h2 class="mb-4">Customer Detail</h2>
      <div id="customer-details"></div>
      <button id="delete-button" class="btn btn-danger">削除</button>
    </div>

    <script type="module">
      import config from "./config.js";

      // URLからcustomerIdを取得
      const urlParams = new URLSearchParams(window.location.search);
      const customerId = urlParams.get('customerId');

      // 削除ボタンの要素を取得
      const deleteButton = document.getElementById("delete-button");

      // 削除ボタンがクリックされたときの処理
      deleteButton.addEventListener("click", () => confirmDelete(customerId));

      function confirmDelete(customerId) {
        const confirmation = confirm("削除していいですか?");
        if (confirmation) {
          // 削除APIエンドポイントにリクエストを送信
          fetch(`${config.apiUrl}/delete-customer/${customerId}`, {
            method: 'DELETE',
          })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              alert('削除が成功しました。');
              // 成功したらリストにリダイレクト
              window.location.href = 'list.html';
            } else {
              alert('削除に失敗しました。');
            }
          })
          .catch(error => {
            console.error('Error:', error);
            alert('エラーが発生しました。');
          });
        }
      }

      // 顧客詳細を表示する処理は省略
    </script>

    <!-- BootstrapのJavaScriptと依存関係のリク -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  </body>
</html>
